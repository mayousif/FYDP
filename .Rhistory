usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
testy
testQ
testcond
tesFs
sum(testcond)
testx
test = c(0,1,1)
test<= 0
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
testy
testFs
tesFs
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
y[((i-1)*stepsPerSection+1+(k-1)*stepsPerSection*sections):(i*stepsPerSection+(k-1)*stepsPerSection*sections)]
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
testb
View(testmatrix)
testshell1
testy
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
testy
testQ
testx
testcond
tesfs
tesFs
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
testy
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Location that program was installed to
MainLocation = getwd()
# Location of run.R, ui.R, and server.R (must also be changed in batch file)
AppLocation = paste(MainLocation,"/shiny", sep = "")
# Location of R packages library
.libPaths("C:/Users/megue/Documents/R/win-library/3.5")
LibraryLocation = paste(MainLocation,"/library", sep = "")
# Install/load required R packages
usePackage = function(p) {
if (!is.element(p, installed.packages()[,1]))
install.packages(p, dep = TRUE,repos = c("http://cran.us.r-project.org","http://r-forge.r-project.org"))
require(p, character.only = TRUE)
}
usePackage("shiny")
usePackage("shinyWidgets")
usePackage("shinyjs")
usePackage("ggplot2")
usePackage("plotly")
usePackage("deSolve")
usePackage("bvpSolve")
usePackage("pracma")
usePackage("nleqslv")
# Launch App
runApp(appDir = AppLocation,launch.browser = T)
# Liquid water properties
dens_lw = function(Temp) {
Tau = 1 - Temp/647.096
y = 17.863 + 58.606*Tau^0.35 - 95.396*Tau^(2/3) + 213.89*Tau - 141.26*Tau^(4/3) # mol/dm^3
y = y*18.015 # kg/m3
return(y)
}
cp_lw = function(Temp) {
y = 276370 - 2090.1*Temp + 8.125*Temp^2 - 0.014116*Temp^3 + 9.3701*10^(-6)*Temp^4 # J/(kmol K)
y = y/18.015 # J/(kg K)
return(y)
}
mu_lw = function(Temp) {
y = exp(-52.843 + 3703.6/Temp + 5.866*log(Temp) -5.879*10^(-29)*T^10) # Pa s
return(y)
}
k_lw = function(Temp) {
y = -0.432 + 0.0057255*Temp - 0.000008078*Temp^2 + 1.861*10^(-9)*Temp^3 # W/(m K)
return(y)
}
# Liquid ethanol properties
dens_le = function(Temp) {
y = 1.6288/(0.27469^(1+(1-Temp/514)^0.23178)) # mol/dm^3
y = y*46.068 # kg/m3
return(y)
}
cp_le = function(Temp) {
y = 102640 - 139.63*Temp - 0.030341*Temp^2 + 0.0020386*Temp^3 # J/(kmol K)
y = y/46.068 # J/(kg K)
return(y)
}
mu_le = function(Temp) {
y = exp(7.875 + 781.98/Temp -3.0418*log(Temp)) # Pa s
return(y)
}
k_le = function(Temp) {
y = 0.2468 - 0.000264*Temp  # W/(m K)
return(y)
}
# Vapour water properties
hvap_vw = function(Temp) {
Tau = 1 - Temp/647.096
y = 5.2053*10^7*(1-Tau)^(0.3199 - 0.212*Tau + 0.25795*Tau^2) # J/kmol
y = y/18.015 # J/kg
return(y)
}
cp_vw = function(Temp) {
y = 0.33363*10^5 + 0.2697*10^5*((2.6105*10^3/Temp)/(sinh((2.6105*10^3)/Temp)))^2 + 0.08896*10^5*((1169/Temp)/(sinh((1169)/Temp)))^2 # J/(kmol K)
y = y/18.015 # J/(kg K)
return(y)
}
mu_vw = function(Temp) {
y = 1.7096*10^-8*Temp^1.1146 # Pa s
return(y)
}
k_vw = function(Temp) {
y = 6.2041*10^-6*Temp^1.3973 # W/m K
return(y)
}
# Vapour ethanol properties
hvap_ve = function(Temp) {
Tau = Temp/514
y = 5.5789*10^7*(1-Tau)^(0.31245) # J/kmol
y = y/46.068 # J/kg
return(y)
}
cp_ve = function(Temp) {
y = 0.492*10^5 + 1.4577*10^5*((1.6628*10^3/Temp)/(sinh((1.6628*10^3)/Temp)))^2 + 0.939*10^5*((744.7/Temp)/(sinh((744.7)/Temp)))^2 # J/(kmol K)
y = y/46.068 # J/(kg K)
return(y)
}
mu_ve = function(Temp) {
y = (1.0613*10^-7*Temp^0.8066)/(1+52.7/Temp) # Pa s
return(y)
}
k_ve = function(Temp) {
y = (-0.010109*Temp^0.6475)/(1-7332/Temp-268000/(Temp^2)) # W /(m K)
return(y)
}
# Vapour water + ethanol properties
hvap_vwe = function(x,y,Temp) {
h1 = hvap_vw(Temp)
h2 = hvap_ve(Temp)
a0 = -3.63868*10^5 + 1.83829*Temp - 2.32763*Temp^2
a1 = 9.25982*10^5 - 4.83586*Temp + 6.37228*Temp^2
a2 = -14.04894*10^5 + 7.51661*Temp - 10.11280*Temp^2
a3 = 10.91318*10^5 - 5.89498*Temp + 7.98868*Temp^2
a5 = -2.79986*10^5 + 1.50557*Temp - 2.03127*Temp^2
# convert to mol fraction
ymol = y/(18.015)/(y/18.015+(1-y)/46.068)
xmol = x/(18.015)/(x/18.015+(1-x)/46.068)
hE = xmol*(1-xmol)*(a0+a1*(1-xmol)^0.5+a2*(1-xmol)^1.5+a3*(1-xmol)^2.5+a5*(1-xmol)^4.5)
hL = (1-x)*cp_le(Temp)*(Temp-273.15)+x*cp_lw(Temp)*(Temp-273.15) + hE
hV = (1-y)*(h2+cp_ve(Temp)*(Temp-273.15))+y*(h1+cp_vw(Temp)*(Temp-273.15))
h = hV - hL # J/kg
return(h)
}
cp_vwe = function(y,Temp) {
c1 = cp_vw(Temp)
c2 = cp_ve(Temp)
c = y*c1 + (1-y)*c2
return(c)
}
mu_vwe = function(y,Temp) {
m1 = mu_vw(Temp)
m2 = mu_ve(Temp)
# convert to mol fraction
y = y/(18.015)/(y/18.015+(1-y)/46.068)
m = (y*m1*sqrt(18.015)+(1-y)*m2*sqrt(46.068))/(y*sqrt(18.015)+(1-y)*sqrt(46.068))
return(m)
}
k_vwe = function(y,Temp) {
k1 = k_vw(Temp)
k2 = k_ve(Temp)
phi12 = 1/sqrt(8)*(1+18.015/46.068)^-0.5*(1+sqrt(mu_vw(Temp)/mu_ve(Temp))*(46.068/18.015)^0.25)^2
phi21 = 1/sqrt(8)*(1+46.068/18.015)^-0.5*(1+sqrt(mu_ve(Temp)/mu_vw(Temp))*(18.015/46.068)^0.25)^2
# convert to mol fraction
y = y/(18.015)/(y/18.015+(1-y)/46.068)
k = y*k1/((1-y)*phi12 + y)+ (1-y)*k2/(y*phi21 +(1-y))
return(k)
}
# Liquid water + ethanol properties
dens_lwe = function(x,Temp) {
A = -9.054199 + 0.01572057*Temp
B = -4.930763 + 0.01241796*Temp
C = 5.286817 - 0.01989784*Temp
# convert to mol fraction
x = x/(18.015)/(x/18.015+(1-x)/46.068)
vE = x*(1-x)*(A + B*(1-2*(1-x)) + C*(1-2*(1-x))^2)/1000000 # m3/mol
MW = (x*18.015+(1-x)*46.068)/1000 # kg/mol
d = MW/(vE+(x*0.018015)/dens_lw(Temp)+((1-x)*0.046068)/dens_le(Temp)) # kg/m3
return(d)
}
cp_lwe = function(x,Temp) {
c1 = cp_lw(Temp)
c2 = cp_le(Temp)
c = x*c1 + (1-x)*c2
return(c)
}
mu_lwe = function(x,Temp) {
m1 = mu_lw(Temp)
m2 = mu_le(Temp)
# convert to mol fraction
x = x/(18.015)/(x/18.015+(1-x)/46.068)
xe = 1-x
m = exp(x*log(m1)+xe*log(m2)+724.652*x*xe/Temp+729.357*x*xe*(x-xe)/Temp + 976.050*x*xe*(x-xe)^2/Temp)
return(m)
}
k_lwe = function(x,Temp) {
k1 = k_lw(Temp)
k2 = k_le(Temp)
k12 = 2/(1/k1 + 1/k2)
# convert to mol fraction
x = x/(18.015)/(x/18.015+(1-x)/46.068)
phi1 = x/dens_lw(Temp)*18.015
phi2 = (1-x)/dens_le(Temp)*46.068
phi11 = phi1/(phi1+phi2)
phi22 = phi2/(phi1+phi2)
k = phi11^2*k1 + 2*phi11*phi22*k12 + phi22^2*k2
return(k)
}
hvap_vwe(0.9,0.5,298)
hvap_vwe(0.9,0.5,298)*0.001728
hvap_vwe(0.9,0.5,298)*0.001278
hvap_vwe(0.9,0.5,298)*0.0012708
hvap_vwe(0.1,0.5,298)*0.0012708
hvap_vwe(0.9,0.5,360)*0.0012708
hvap_vwe(0.5,0.1,360)*0.0012708
1400*.0017208
1400*.0012708
